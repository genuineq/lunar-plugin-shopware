!function(e){var n={};function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:i})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(i,r,function(n){return e[n]}.bind(null,r));return i},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="/bundles/lunarpayment/",t(t.s="OgNo")}({"+RLx":function(e,n){e.exports='{% block lunar_payment %}\n<sw-page class="lunar-payment">\n\n    {% block lunar_payment_header %}\n    <template #smart-bar-header>\n        <h2>\n            {{ $tc(\'sw-settings.index.title\') }}\n            <sw-icon name="small-arrow-medium-right" small></sw-icon>\n            {{ $tc(\'lunar-payment.title\') }}\n        </h2>\n    </template>\n    {% endblock %}\n\n    {% block lunar_payment_actions %}\n    <template #smart-bar-actions>\n        {% block lunar_payment_settings_actions_save %}\n        <sw-button-process\n                class="sw-settings-login-registration__save-action"\n                :isLoading="isLoading"\n                :processSuccess="isSaveSuccessful"\n                :disabled="isLoading"\n                variant="primary"\n                @process-finish="saveFinish"\n                @click="onSave">\n            {{ $tc(\'lunar-payment.settingsForm.save\') }}\n        </sw-button-process>\n        {% endblock %}\n    </template>\n    {% endblock %}\n\n\n    {% block lunar_payment_settings_content %}\n    <template #content>\n        <sw-card-view>\n            <sw-system-config\n                class="lunar-config__wrapper"\n                ref="systemConfig"\n                salesChannelSwitchable\n                inherit\n                @config-changed="onConfigChange"\n                domain="LunarPayment.settings">\n\n                <template #card-element="{element, config, card}">\n                    <div>\n\n                        <sw-form-field-renderer\n                            v-if="!element.name.includes(\'transactionMode\') || !element.name.includes(\'supportedCards\') || !element.name.includes(\'captureMode\')"\n                            v-bind="getElementBind(getBind(element, config))"\n                            v-model="config[element.name]"\n                        />\n\n                        <sw-form-field-renderer\n                            v-else-if="element.name.startsWith(\'LunarPayment.settings.transactionMode\')"\n                            :config="{\n                                componentName: \'sw-single-select\',\n                                label: getInlineSnippet(getElementBind(getBind(element, config)).config.label),\n                                helpText: getInlineSnippet(getElementBind(getBind(element, config)).config.helpText),\n                                options: transactionMode,\n                            }"\n                            v-model="config[element.name]"\n                        />\n\n                        <sw-form-field-renderer\n                            v-else-if="element.name.startsWith(\'LunarPayment.settings.captureMode\')"\n                            :config="{\n                                componentName: \'sw-single-select\',\n                                label: getInlineSnippet(getElementBind(getBind(element, config)).config.label),\n                                helpText: getInlineSnippet(getElementBind(getBind(element, config)).config.helpText),\n                                options: captureMode,\n                            }"\n                            v-model="config[element.name]"\n                        />\n\n                        <sw-form-field-renderer\n                            v-else-if="element.name.startsWith(\'LunarPayment.settings.supportedCards\')"\n                            :config="{\n                                componentName: \'sw-multi-select\',\n                                label: getInlineSnippet(getElementBind(getBind(element, config)).config.label),\n                                helpText: getInlineSnippet(getElementBind(getBind(element, config)).config.helpText),\n                                options: acceptedCards,\n                            }"\n                            v-model="config[element.name]"\n                        />\n\n                    </div>\n                </template>\n            </sw-system-config>\n        </sw-card-view>\n    </template>\n    {% endblock %}\n\n</sw-page>\n{% endblock %}\n'},HKqZ:function(e,n,t){var i=t("y0UL");i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);(0,t("SZ7m").default)("633a95cc",i,!0,{})},OgNo:function(e,n,t){"use strict";t.r(n);var i=t("pqxS"),r=t.n(i);t("gSks");Shopware.Component.register("lunar-payment-plugin-icon",{template:r.a});var o=t("VXoL"),a=t.n(o);t("HKqZ");Shopware.Component.override("sw-settings-index",{template:a.a});var s=t("+RLx"),l=t.n(s),c=Shopware,u=c.Component,f=c.Mixin,p=Shopware.Utils,d=p.object;p.types;u.register("lunar-settings",{template:l.a,mixins:[f.getByName("notification"),f.getByName("sw-inline-snippet")],props:{},inject:["LunarPaymentSettingsService"],data:function(){return{isLoading:!1,isTesting:!1,isSaveSuccessful:!1,isTestSuccessful:!1,config:{},configPath:"LunarPayment.settings.",liveAppConfigKey:"liveModeAppKey",livePublicConfigKey:"liveModePublicKey",testAppConfigKey:"testModeAppKey",testPublicConfigKey:"testModePublicKey",liveAppKeyFilled:!1,livePublicKeyFilled:!1,testAppKeyFilled:!1,testPublicKeyFilled:!1,showValidationErrors:!1,transactionMode:[],captureMode:[],acceptedCards:[]}},created:function(){this.generateFieldsOptions()},computed:{credentialsMissing:function(){return!this.testAppKeyFilled||!this.testPublicKeyFilled}},metaInfo:function(){return{title:this.$createTitle()}},methods:{saveFinish:function(){this.isSaveSuccessful=!1},onConfigChange:function(e){this.config=e,this.checkCredentialsFilled(),this.showValidationErrors=!1},checkCredentialsFilled:function(){this.testAppKeyFilled=!!this.getConfigValue(this.testAppConfigKey),this.testPublicKeyFilled=!!this.getConfigValue(this.testPublicConfigKey)},getConfigValue:function(e){var n=this.$refs.systemConfig.actualConfigData.null;return null===this.$refs.systemConfig.currentSalesChannelId?this.config["".concat(this.configPath).concat(e)]:this.config["".concat(this.configPath).concat(e)]||n["".concat(this.configPath).concat(e)]},onSave:function(){var e=this;if(this.credentialsMissing)this.showValidationErrors=!0;else{this.isSaveSuccessful=!1,this.isLoading=!0;var n={testModeAppKey:this.getConfigValue(this.testAppConfigKey),testModePublicKey:this.getConfigValue(this.testPublicConfigKey)};this.LunarPaymentSettingsService.validateApiKeys(n).then((function(n){var t=n.credentialsValid,i=n.errors;if(t)e.createNotificationSuccess({title:"success title",message:"valid success message"}),e.$refs.systemConfig.saveAll().then((function(){e.isLoading=!1,e.isSaveSuccessful=!0})).catch((function(n){e.createNotificationError({title:"config save error title",message:"config save error general message"}),e.isLoading=!1,e.isSaveSuccessful=!1}));else for(var r in i)i.hasOwnProperty(r)&&e.createNotificationError({title:"error title",message:"error validation message"});e.isLoading=!1})).catch((function(n){e.createNotificationError({title:"general error title",message:"error general message"}),e.isLoading=!1,e.isSaveSuccessful=!1}))}},generateFieldsOptions:function(){this.transactionMode.push({label:"Live",value:"live"},{label:"Test",value:"test"}),this.captureMode.push({label:"Delayed",value:"delayed"},{label:"Instant",value:"instant"}),this.acceptedCards.push({label:"Visa",value:"visa"},{label:"Visaelectron",value:"visaelectron"},{label:"Mastercard",value:"mastercard"},{label:"Maestro",value:"maestro"})},getBind:function(e,n){var t;return n!==this.config&&(this.config=n),this.showValidationErrors&&(e.name!=="".concat(this.configPath).concat(this.testAppConfigKey)||this.testAppKeyFilled||(e.config.error={code:1,detail:"The App Key must not be empty"}),e.name!=="".concat(this.configPath).concat(this.testPublicConfigKey)||this.testPublicKeyFilled||(e.config.error={code:1,detail:"The Public Key must not be empty"})),this.$refs.systemConfig.config.forEach((function(n){n.elements.forEach((function(n){n.name!==e.name||(t=n)}))})),t||e},getElementBind:function(e){var n=d.deepCopyObject(e);return["single-select","multi-select"].includes(n.type)&&(n.config.labelProperty="name",n.config.valueProperty="id"),n}}}),Shopware.Module.register("lunar-payment",{type:"plugin",name:"LunarPayment",title:"Lunar Payment",description:"Lunar Payment plugin",version:"1.0.0",targetVersion:"1.0.0",icon:"default-action-settings",routes:{index:{component:"lunar-settings",path:"index",meta:{parentPath:"sw.settings.index"}}},settingsItem:{group:"plugins",to:"lunar.payment.index",iconComponent:"lunar-payment-plugin-icon",backgroundEnabled:!0}});t("taNh")},SZ7m:function(e,n,t){"use strict";function i(e,n){for(var t=[],i={},r=0;r<n.length;r++){var o=n[r],a=o[0],s={id:e+":"+r,css:o[1],media:o[2],sourceMap:o[3]};i[a]?i[a].parts.push(s):t.push(i[a]={id:a,parts:[s]})}return t}t.r(n),t.d(n,"default",(function(){return g}));var r="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!r)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var o={},a=r&&(document.head||document.getElementsByTagName("head")[0]),s=null,l=0,c=!1,u=function(){},f=null,p="data-vue-ssr-id",d="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function g(e,n,t,r){c=t,f=r||{};var a=i(e,n);return m(a),function(n){for(var t=[],r=0;r<a.length;r++){var s=a[r];(l=o[s.id]).refs--,t.push(l)}n?m(a=i(e,n)):a=[];for(r=0;r<t.length;r++){var l;if(0===(l=t[r]).refs){for(var c=0;c<l.parts.length;c++)l.parts[c]();delete o[l.id]}}}}function m(e){for(var n=0;n<e.length;n++){var t=e[n],i=o[t.id];if(i){i.refs++;for(var r=0;r<i.parts.length;r++)i.parts[r](t.parts[r]);for(;r<t.parts.length;r++)i.parts.push(y(t.parts[r]));i.parts.length>t.parts.length&&(i.parts.length=t.parts.length)}else{var a=[];for(r=0;r<t.parts.length;r++)a.push(y(t.parts[r]));o[t.id]={id:t.id,refs:1,parts:a}}}}function h(){var e=document.createElement("style");return e.type="text/css",a.appendChild(e),e}function y(e){var n,t,i=document.querySelector("style["+p+'~="'+e.id+'"]');if(i){if(c)return u;i.parentNode.removeChild(i)}if(d){var r=l++;i=s||(s=h()),n=S.bind(null,i,r,!1),t=S.bind(null,i,r,!0)}else i=h(),n=w.bind(null,i),t=function(){i.parentNode.removeChild(i)};return n(e),function(i){if(i){if(i.css===e.css&&i.media===e.media&&i.sourceMap===e.sourceMap)return;n(e=i)}else t()}}var v,b=(v=[],function(e,n){return v[e]=n,v.filter(Boolean).join("\n")});function S(e,n,t,i){var r=t?"":i.css;if(e.styleSheet)e.styleSheet.cssText=b(n,r);else{var o=document.createTextNode(r),a=e.childNodes;a[n]&&e.removeChild(a[n]),a.length?e.insertBefore(o,a[n]):e.appendChild(o)}}function w(e,n){var t=n.css,i=n.media,r=n.sourceMap;if(i&&e.setAttribute("media",i),f.ssrId&&e.setAttribute(p,n.id),r&&(t+="\n/*# sourceURL="+r.sources[0]+" */",t+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */"),e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},VXoL:function(e,n){e.exports='{% block sw_settings_content_card_slot_plugins %}\n    {% parent %}\n\n    <sw-settings-item :label="$tc(\'lunar-payment.general.mainMenuItemGeneral\')"\n                      :to="{ name: \'lunar.payment.index\' }"\n                      :backgroundEnabled="false">\n        <template #icon>\n            <img class="sw-settings-index__lunar-icon" :src="\'lunarpayment/plugin.png\' | asset">\n        </template>\n    </sw-settings-item>\n{% endblock %}\n'},gSks:function(e,n,t){var i=t("ow9+");i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);(0,t("SZ7m").default)("5c83786c",i,!0,{})},"ow9+":function(e,n,t){},pqxS:function(e,n){e.exports='{% block lunar_payment_plugin_icon %}\n    <img class="lunar-payment-plugin-icon" :src="\'lunarpayment/plugin.png\' | asset">\n{% endblock %}\n'},taNh:function(e,n){function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function r(e,n){for(var t=0;t<n.length;t++){var i=n[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function o(e,n){return(o=Object.setPrototypeOf||function(e,n){return e.__proto__=n,e})(e,n)}function a(e){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,i=l(e);if(n){var r=l(this).constructor;t=Reflect.construct(i,arguments,r)}else t=i.apply(this,arguments);return s(this,t)}}function s(e,n){if(n&&("object"===t(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var c=Shopware.Application,u=Shopware.Classes.ApiService,f=function(e){!function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),n&&o(e,n)}(c,e);var n,t,s,l=a(c);function c(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"lunar_payment";return i(this,c),l.call(this,e,n,t)}return n=c,(t=[{key:"validateApiKeys",value:function(e){var n=this.getBasicHeaders();return this.httpClient.post("_action/".concat(this.getApiBasePath(),"/validate-api-keys"),{keys:e},{headers:n}).then((function(e){return u.handleResponse(e)}))}}])&&r(n.prototype,t),s&&r(n,s),Object.defineProperty(n,"prototype",{writable:!1}),c}(u);c.addServiceProvider("LunarPaymentSettingsService",(function(e){var n=c.getContainer("init");return new f(n.httpClient,e.loginService)}))},y0UL:function(e,n,t){}});